# Sweetest 更新日志


## 版本 0.9.12 (2019.08.30)

- 优化执行日志

- 优化失败信息

- 点击支持js点击模式

当无法正常点击到元素时，可以指定用 js 强制点击，只需要在测试数据里写上：`mode=js`

| 操作    | 页面    | 元素     |  测试数据  |
| ------  | ------ | -------- | ---------- |
| `点击`  | 百度    | 搜索按钮  | `mode=js` |


- 把测试数据文件中的对应数据全部循环执行，则循环次数写为 `N`,即 `SNIPPET_ID*N`，如：

| 操作  | 页面    | 元素             | 测试数据       |
| ----- | ------- | --------------- | ------------- |
| 执行  | 用例片段 | `SNIPPET_001*N` |  `kw=<_kw>`   |

- 支持随机数

<> 运算中支持直接使用 random 库，如：指定范围的一个随机整数，写作

| 操作   | 页面    | 元素   | 测试数据 |
| ------ | ------ | ------ | ------- |
| `输入`  | 百度   | 搜索框 |   `<random.randint(1,10)>,,`  |

注意用双逗号分割。

详细使用方法可参见文章：https://www.cnblogs.com/skyEva/p/6097157.html


## 版本 0.9.11 (2019.08.02)

- 支持文件操作，如：复制，移动，删除，文件判断，文件夹判断
- 支持命令行操作

详细说明见文档 ## 文件及命令行 章节


## 版本 0.9.10 (2019.07.19)

- JUnit 报告文件中，增加 blocked, skipped 统计
- 输入关键字：如果输入是具有联想下拉菜单时 可能需要逐字输入功能（模拟真实的键盘输入场景），应写为 `word=...`,如：

| 操作    | 页面    | 元素   | 测试数据 |
| ------- | ------  | ----- | ------- |
| `输入`  | 百度搜索页 | 搜索框 | word=搜狗 |

- 截图比较：现在的截图对比的输出图片可以显示差异部分了
- 优化截图的文件名


## 版本 0.9.8 (2019.07.05)

- 点击操作：当元素为不可点击状态时，等待1秒后再次点击
- 变量替换：测试数据中出现非变量标识的 `<` 或 `>` 时，需要用反斜杠(`\`)转义，如 `\<`，`\>`



## 版本 0.9.7 (2019.06.21)

- 域名更改：

文档：https://sweeter.io

社区: https://o.sweeter.io (精力有限，无法及时维护，有问题建议在 Github 上提 issue)

- 增加左侧入参函数功能（简称：左侧函数），用于检查关键字中。

| 操作  | 页面   | 元素  | 测试数据    |
| ----- | ----- | ----- | ---------- |
| 检查  |  首页 |  金额  |  text=`:f(v, 100),,` |

如上表，冒号(:)开头表示后面为左侧函数，f 为函数名，v 表示等号(=)左侧的值，100 是其他参数(可以为变量，如`<p>`)。

注意:

    - 用例里 f 的第一个参数一定要是 v
    - 以双逗号(,,)分割

- 增加内置左侧函数 f，用来比较数值。

如：实际值 text='1,234.567'，预期值：p=1234.57，当浮点精度为2时，测试数据写作：`text=:f(v, <p>, 2)`，结果为通过

如果预期值：p='1,234.57'，为字符串，则 <p> 需要带引号：`text=:f(v, '<p>', 2)`

当浮点精度为3时，测试数据写作：`text=:f(v, <p>, 3)`，结果为失败


- 当需要自定义左侧函数时，请在 c.py 或 u.py 中定义，测试用例中，应该写作：text=`:c.myfunc(v, 'foo')`

- 优化变量替换函数


## 版本 0.9.6 (2019.06.13)

- Windows GUI 测试：支持 selected, checked, enabled, visible, focused 等状态检查
- Windows GUI 测试：支持重置窗口(即关闭其他窗口，直到指定窗口在最前面)
- 优化 float 比较
- 编写一小部分 Windows GUI 自动化测试文档


## 版本 0.9.5 (2019.06.06)

- Windows GUI 测试：支持右击关键字
- Windows GUI 测试：支持截图和截图对比（用法和 Web 中一致）
- SQL 测试：支持 sql 语句中使用函数，如：select Round(price*6, 4) as p from product;


## 版本 0.9.3 (2019.05.31)

- Windows GUI 测试支持检查关键字，检查内容包括：text，value
- 支持输出 text，value
- 支持 win32、uia 混合模式测试
- 优化菜单关键字对 uia 模式的支持
- notepad 用例增加新功能示例


## 版本 0.9.2 (2019.05.13)

- 支持滚动条操作

对于页面已加载的元素，如果该元素不在可视区域，则框架会自动尝试滚动到元素可见；但有以下2种情况不适用
1. 动态加载的元素(即尚未加载的元素)
2. 内嵌滚动条中被遮挡的元素

对应的，滚动条操作的对象可以是整个页面，也可以是有滚动条的内嵌窗口

- 整个页面格式如下表，元素为空，测试数据为滚动位移，默认值为竖轴(y)，也可以设置横轴(x)

| 操作  | 页面   | 元素  | 测试数据    |
| ----- | ----- | ----- | ---------- |
| 滚动条 |  首页 |       |  10000     |

测试数据也可以写：`y=1000` 或 `x=500` 或 `y=1000,x=500`

- 内嵌滚动条格式，测试数据如页面格式。

| 操作  | 页面   | 元素     | 测试数据    |
| ----- | ----- | -------- | ---------- |
| 滚动条 |  首页 | timeline |  10000     |

## 版本 0.9.1 (2019.04.30)

- 支持在 Web UI 测试中添加自定义 cookie

| 操作 | 页面 | 元素 | 测试数据 |
| --- | --- | --- | ---|
| 打开 | 通用|百度首页 | 标签页名=百度,,cookie={'domain':'.baidu.com', 'name': 'SWEETEST', 'value': '888888'}|

cookie 可以是通过自定义函数获取

| 操作 | 页面 | 元素 | 测试数据 |
| --- | --- | --- | ---|
| 打开 | 通用|百度首页 | 标签页名=百度,cookie=<c.get_cookie()>|



## 版本 0.9.0 (2019.04.26)

- 初步支持 Windows GUI 测试
- 增加测试 Windows 记事本的实例
- 修复 bug：sweetest 命令会创建一个多余的log文件
- 优化：Excel 测试结果中，测试数据显示变量值
- 优化：Excel 汇总结果中，增加执行失败用例列表

体验 Windows GUI 示例，请先自行安装依赖库

`pip install pypiwin32`

`pip install pywinauto`



## 版本 0.8.51 (2019.04.15)

- 修复 bug：比较全屏截图功能-实际上没有截图
- 优化：在 headless 模式下，截图为整个页面

    - 之前的截图功能只能是屏幕可见区域（IE 浏览器可截图整个页面）
    - 现在优化为在 headless 模式下，截图是整个页面，但 Chrome/Firefox 正常模式还是无法截取整个页面


## 版本 0.8.50 (2019.03.27)

- 支持在 `<>` 中取 list 中的值

  > 如：已通过自定义脚本赋值了 queue = `[[1,2,3],[4,5,6]]`, 则 `<queue[0][1]>` 值为 `2`

- 支持在 `<>` 中取 dict 的键值

  > 如：已通过自定义脚本赋值了 apple = `{'color': 'red'}`, 则 `<apple['color']>` 值为 `'red'`


## 版本 0.8.46 (2019.03.14)

- logo 更新
- 修复 bug


## 版本 0.8.43 (2019.03.05)

- Excel 测试报告中增加汇总信息页
- Excel 测试报告目录优化
- 代码美化


## 版本 0.8.41 (2019.03.01) 

- 支持在启动脚本设置全局截屏模式
- 支持在输出数据中填写全屏或元素截图，并赋值给变量
- 支持全屏或元素截图对比
 
 详情见文档**全屏及元素截图比较**章节。


## 版本 0.8.39 (2019.02.22) 

- 支持 headless 模式
- 修复`变量赋值`关键字无效的 bug
- 优化：把`等待时间`的执行顺序提前到`变量替换`之前